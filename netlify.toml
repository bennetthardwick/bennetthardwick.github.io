[build]
# This assumes that the Zola site is in a docs folder. If it isn't, you don't need
# to have a `base` variable but you do need the `publish` and `command` variables.
base    = "."
publish = "./output"
command = """
zola build && \
wget https://github.com/bennetthardwick/static-site-optimizer/releases/download/0.4.0/static-site-optimizer && \
chmod +x ./static-site-optimizer && \
./static-site-optimizer ./public --base-url https://bennetthardwick.com --outdir ./output --amp --gtag UA-153493405-1
"""

[build.environment]
# Set the version name that you want to use and Netlify will automatically use it.
ZOLA_VERSION = "0.11.0"

# The magic for deploying previews of branches.
# We need to override the base url with whatever url Netlify assigns to our
# preview site.  We do this using the Netlify environment variable
# `$DEPLOY_PRIME_URL`.

[context.deploy-preview]
command = """
zola build --base-url $DEPLOY_PRIME_URL && \
wget https://github.com/bennetthardwick/static-site-optimizer/releases/download/0.4.0/static-site-optimizer && \
chmod +x ./static-site-optimizer && \
./static-site-optimizer ./public --base-url $DEPLOY_PRIME_URL --outdir ./output --amp --inline-styles --gtag UA-153493405-1
"""
